<?  $Loader->Parent_Class('/Builder/Asset/Cpp/Compile');  class C_Builder_Asset_Cpp_MakeLib extends C_Builder_Asset_Cpp_Compile  {    Function Make($Outer, $Compiler, $Param)    {      // $Mode==0 -- No compile, only source      // $Mode==1 -- Compile but only object files      // $Mode==2 -- Compile but one liberary file      // $Mode==3 -- Compile and generate DLL if avalible      $Mode=3; // TODO: Customization      $bDebug=false;            $DLL=IsSet($Param['DLL'])? $Param['DLL']:'';      $IsDll = $Mode>=3 && $DLL!=='';      $IsLib = $Mode>=2 && !$IsDll;      $IsObj = $Mode>=1;      $LibName=$this->_GetName($Outer);            $PathObj='Obj';      $PathLib='Lib';      $PathDll='Bin';            $PathObjType='Cpp/ObjPath' ;      $PathLibType='Cpp/LibPath' ;      $PathDllType='Bin/Path'    ;      $PathObjAsset=$Outer->CreateAsset($PathObjType, $PathObj);      $PathLibAsset=$Outer->CreateAsset($PathLibType, $PathLib);      $PathDllAsset=$Outer->CreateAsset($PathDllType, $PathDll);            if($DLL!=='')      {        if($IsDll)          $Outer->CreateAsset('Cpp/Define', [$DLL=>$Compiler->DefineDLLExport()]);        else          $Outer->CreateAsset('Cpp/Define', [$DLL=>'']);      }            if($IsObj)        $this->Compile($Outer, $Compiler, $Param);          if($IsDll)      {        $Compiler->BuildDll([          'Exec'     =>$Outer->CreateExec(),          'Objects'  =>$Outer->RemoveAssets  ('Cpp/Obj'),          'Libs'     =>$Outer->GetAssetsR    ('Cpp/Lib'),          'DllAsset' =>$Outer->CreateAsset   ('Bin/Dll', ['Path'=>$Compiler->GetDllFile    ($LibName, $bDebug)]),          'LibAsset' =>$Outer->CreateAsset   ('Cpp/Lib', ['Path'=>$Compiler->GetDllLibFile ($LibName, $bDebug)]),        ]);        $Outer->CreateAsset('Cpp/Define', [$DLL=>$Compiler->DefineDLLImport()]);      }      if($IsLib)      {        $Compiler->BuildLib([          'Exec'     =>$Outer->CreateExec(),          'Objects'  =>$Outer->RemoveAssets  ('Cpp/Obj'),          'Libs'     =>[], //$Outer->GetAssetsR    ('Cpp/Lib'),          'LibAsset' =>$Outer->CreateAsset   ('Cpp/Lib', ['Path'=>$Compiler->GetLibFile ($LibName, $bDebug)]),        ]);      }      $PathObjAsset->Remove();      $PathLibAsset->Remove();      $PathDllAsset->Remove();    //$Outer->CreateAsset('CPP/Define', ['TestBadObject']); // Check generate error    }  };?>