<?
  for($F=__FILE__; $F;) if(@include($F=DirName($F)).'/Using.php') break;

  $SlnOutDir='Res/'; // ..
  $VcxOutDir='Res/'; // ..
  
  $Data=[
    'AbsPath'   =>'SlnDir/',
    'VcxAbsPath'=>'VcxDir/', // 'Builder/Build/VStudio', // ..
    'CustomProps'=>[
      ['PropertyGroup', 'Condition'=>'\'$(SimpleConfig)\'==\'Release\'', 'Label'=>'Configuration_d',
        ['_d', ''],
      ],
      ['PropertyGroup', 'Condition'=>'\'$(SimpleConfig)\'==\'Debug\'', 'Label'=>'Configuration_d',
        ['_d', '_d'],
      ],
    ],
    'NMakeCompiler'=>[],
    'Name'=>'MySolution',
    'Type'=>'C++',
  //'ProjectFile'=> $Dir.$Name.'sln',
    'Platforms'=>[
      'Win32'   =>[                 'Real'=>'Win32' ,'Props'=>['WUse'=>'WBuild'  ,'ConfigPath'=>'{Var:ConfigPath}32'       ]],
      'Win64'   =>[                 'Real'=>'x64'   ,'Props'=>['WUse'=>'WBuild'  ,'ConfigPath'=>'{Var:ConfigPath}'         ]],
      'WinArm'  =>[                 'Real'=>'arm'   ,'Props'=>['WUse'=>'WBuild'  ,'ConfigPath'=>'{Var:ConfigPath}_Arm'     ]],
      'Linux'   =>['>'=>'_Linux'   ,'Real'=>'Win32' ,'Props'=>['WUse'=>'WBuild'  ,'ConfigPath'=>'{Var:ConfigPath}_Linux'   ]],
      'MSBuild' =>['<'=>'MSBuild ' ,'Real'=>'Win32' ,'Props'=>['WUse'=>'MSBuild' ,'ConfigPath'=>'{Var:ConfigPath}_MSBuild' ]],
      'DoxyGen' =>['<'=>'DoxyGen ' ,'Real'=>'Win32' ,'Props'=>['WUse'=>'DoxyGen' ,'ConfigPath'=>'{Var:ConfigPath}_DoxyGen' ]],
    ],
    'Configs'=>[
      'Development' =>['Props'=>['SimpleConfig'=>'Release' ,'ConfigPath'=>'Development' ]],
      'Debug'       =>['Props'=>['SimpleConfig'=>'Debug'   ,'ConfigPath'=>'Debug'       ]],
      'Full Debug'  =>['Props'=>['SimpleConfig'=>'Debug'   ,'ConfigPath'=>'FullDebug'   ]],
      'Fast Debug'  =>['Props'=>['SimpleConfig'=>'Release' ,'ConfigPath'=>'FastDebug'   ]],
      'Shipping'    =>['Props'=>['SimpleConfig'=>'Release' ,'ConfigPath'=>'Shipping'    ]],
    ],
    'Projects'=>[
      'Project1'=>[
        'NMakeCompiler'=>['Import', 'Project'=>'$(ProjectDir)\Project1.vcxproj.compiler'],
      ],
      'Project2'=>[
        'NMakeCompiler'=>['Import', 'Project'=>'$(ProjectDir)\Project2.vcxproj.compiler'],
      ],
      '/Folder'=>[
        'Projects'=>[
          'SubProject1'=>[
            'Depends'=>['Project2', 'SubProject2'],
            'AbsDir'=>'Folder',
          ],
          'SubProject2'=>[
            'Depends'=>['Project2'],
            'AbsDir'=>'Folder',
          ],
          'SubProject3'=>[
            'Type'=>'C++',
            'Depends'=>['SubProject2'],
            'AbsDir'=>'Folder',
          ],
        ],
      ],
    ],
  ];

  $Loader->GetLogger()->Add('Make.log');
  $Solution=$Loader->Create_Object('/Builder/Program/VS/Solution', $Data);
  $Solution->SaveToFiles($SlnOutDir, $VcxOutDir);
?>